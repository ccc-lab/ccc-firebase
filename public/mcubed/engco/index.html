<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <meta http-equiv="content-language" content="en-EN" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

        <title>.: LIGHT INTENSITY PUPIL MEASUREMENT :.</title>
        <!-- include the main pupillometry script : -->
        <script type="text/javascript" src="../../dist/jeelizPupillometry.js"></script>

        <!-- include the helpers : -->
        <script type="text/javascript" src="../../helpers/TabManager.js"></script>
        <script type="text/javascript" src="../../libs/plotly/plotly-1.39.2.min.js"></script>
        <script type="text/javascript" src="../../helpers/ExperimentRecorder.js"></script>

        <!-- main script : -->
        <script type="text/javascript" src="Experiment.js"></script>

        <link rel='stylesheet' type='text/css' href='style.css' />
        <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">

    </head>
    <body onload="Experiment.init();">

        <!-- Tab links -->
        <div class="tabLinks">
          <button class="tabLink tabLinkActive" onclick="TabManager.open(event, 'tabContent-debugView')">Debug view</button>
          <button class="tabLink" onclick="TabManager.open(event, 'tabContent-experiment')">Experiment</button>
          <button class="tabLink" id='tabLink-results' onclick="TabManager.open(event, 'tabContent-results')">Raw results</button>
          <button class="tabLink" id='tabLink-resultsAvg' onclick="TabManager.open(event, 'tabContent-resultsAvg')">Averaged results</button>
          <button class="tabLink" onclick="TabManager.open(event, 'tabContent-about')">About</button>
        </div>

        <!-- Tab content -->
        <div class='tabContent' style='display: block' id='tabContent-debugView'>
            <canvas width="1024" height="1024" id='jeePupilCanvas'></canvas>
            <div class='jeePupilControls'>
                <label>Iris edge border size :</label>
                <input oninput='JEEPUPILAPI.update_controls()' type='range' id='jeePupilControlIrisEdgeSize'  min='0.5' max='4.5' value='3.0' step='0.5'/><br/>

                <label>Iris border thresholding :</label>
                <input oninput='JEEPUPILAPI.update_controls()' type='range' id='jeePupilControlIrisThres'  min='0.1' max='0.9' value='0.2' step='0.1'/><br/>

                <label>Iris roundness (a/b) :</label>
                <input oninput='JEEPUPILAPI.update_controls()' type='range' id='jeePupilControlIrisRoundness'       min='0.8' max='1.2' value='1.04' step='0.02'/><br/>

                <label>Pupil detect sensitivity :</label>
                <input oninput='JEEPUPILAPI.update_controls()' type='range'        id='jeePupilControlPupilSensitivity'    min='0' max='0.3' value='0.15' step='0.002'/>
            </div>
        </div>

        <div class='tabContent' style='display: none' id='tabContent-experiment'>
            <div class='experiment-notice'>Switch to full screen mode (F11),<br/>
                maximize the brightness of your screen,<br/>
                than click on the START EXPERIMENT button to start.</div>
            <div id='experiment-screen'>
                <div class='experiment-point'>
                Look at<br/>
                this circle
                </div>
            </div>
            <button id='experiment-stopStartButton' onClick='Experiment.toggle()'>START EXPERIMENT</button>
        </div>

        <div class='tabContent' style='display: none' id='tabContent-results'>
            <div class='results'>
                <div id='results-noResults'>There are no results yet. Please run and complete an experiment before</div>
                <div id='results-plot'></div>
                <div id='results-caption'>
                    Horizontal axis &rarr; time in seconds, Vertical axis &rarr; &lt;pupilRadius&gt;/&lt;irisRadius&gt;
                </div>
            </div>
        </div>

        <div class='tabContent' style='display: none' id='tabContent-resultsAvg'>
            <div class='results'>
                <div id='resultsAvg-noResults'>There are no results yet. Please run and complete an experiment before</div>
                <div id='resultsAvg-plot'></div>
                <div id='resultsAvg-caption'>
                </div>
            </div>
        </div>

        <div class='tabContent' style='display: none' id='tabContent-about'>
            <div class='about'>
            <p>
            The experimental setup is inspired by the paper of Edwin S. Dalmaijer from the Department of Experimental Psychology, University of Oxford, Oxford, United Kingdom published in November 2014. The author compares a low-cost eye tracker (the EyeTribe eye tracker) with an expensive one. The pupillometry is tested in the section 3.3. <a href='../../doc/eyetribeReview.pdf'>You can find this publication here</a>.
            </p>

            <p>
            We use <a href='https://jeeliz.com'>Jeeliz</a> pupillometry to measure the radius of the pupil. The github repository of the project can be found <a href='https://github.com/jeeliz/jeelizPupillometry'>here</a>.
            </p>
            </div>
        </div>

    </body>
</html>
 
